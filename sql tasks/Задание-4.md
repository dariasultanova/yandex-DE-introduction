# Урок 4. Задание 4

| Краткие | детали |
| --- | --- |
| Проверяемый файл     | *./realization.sql*            |
| Проверяемая сущность | *SQL запрос к СУБД PostgreSQL* |

- - -

## Задание

В текущей папке в файл `realization.sql` напишите запрос для следующего задания:

Запрос из предыдущего задания получился очень громоздкий. Читать его сложно и неудобно. Сделайте запрос более понятным, вынеся все подзапросы в CTE.

<details>
<summary><b>Подсказка</b></summary>
Вынесите подзапросы выше и вставьте их в конструкцию `WITH ... AS ...`.
</details>
