# Урок 4. Задание 2

| Краткие | детали |
| --- | --- |
| Проверяемый файл     | *./realization.sql*            |
| Проверяемая сущность | *SQL запрос к СУБД PostgreSQL* |

- - -

## Задание

В текущей папке в файл `realization.sql` напишите запрос для следующего задания:

В витрине данные нужны совокупно по каждому клиенту – поэтому метрики из предыдущего задания нужно агрегировать.

Выгрузите первые 10 записей, содержащих для каждого пользователя:

- `client_id` – идентификатор клиента;
- `fst_visit_dt` – дату первого посещения сайта;
- `registration_dt` – дату регистрации. Если таких событий несколько, возьмите самое раннее;
- `is_registration` – флаг регистрации: `1`, если пользователь зарегистрировался, и `0` – иначе.

<details>
<summary><b>Подсказка</b></summary>
Чтобы найти факт регистрации, используйте агрегирующую функцию MAX.
</details>
