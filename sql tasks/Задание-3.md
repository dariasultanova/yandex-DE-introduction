# Урок 4. Задание 3

| Краткие | детали |
| --- | --- |
| Проверяемый файл     | *./realization.sql*            |
| Проверяемая сущность | *SQL запрос к СУБД PostgreSQL* |

- - -

## Задание

В текущей папке в файл `realization.sql` напишите запрос для следующего задания:

Помимо данных по посещению и регистрации, в витрине необходима также информация о платежах и о маркетинговой кампании, чтобы проанализировать оборот. Для этого нужно объединить данные из нескольких таблиц.

Соберите все данные в витрину с полями:

- `client_id` – идентификатор клиента;
- `utm_campaign` – маркетинговая кампания;
- `fst_visit_dt` – дата первого посещения сайта;
- `registration_dt` – дата регистрации клиента;
- `is_registration` – `1`, если клиент регистрировался, `0` – иначе;
- `total_payment_amount` – сумма платежей клиента.

Используйте подзапросы.

<details>
<summary><b>Подсказка 1</b></summary>
Используйте два раза метод JOIN, чтобы объединить данные из всех трёх таблиц.
</details>

<details>
<summary><b>Подсказка 2</b></summary>
Используйте GROUP BY в подзапросе, чтобы объединить уже агрегированные данные.
</details>
